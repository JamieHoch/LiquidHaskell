<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/home/jamie/Documents/Master/MasterThesis/master-thesis-project/lh-thesis/src/Lib.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##1179 : GHC.Types.Module | $k_##1180}</span><span class='hs-keyword'>{-@</span></a> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--reflection"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 2: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Lib</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 5: </span>
<span class=hs-linenum> 6: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 7: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Liquid.ProofCombinators</span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Liquid.RTick</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>RTick</span>
<span class=hs-linenum> 9: </span>
<span class=hs-linenum>10: </span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nil</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Cons</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>12: </span>
<span class=hs-linenum>13: </span><span class='hs-comment'>-- push &amp; pop</span>
<span class=hs-linenum>14: </span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>length</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>length</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>| v = (len xs)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>17: </span><span class='hs-definition'>length</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>18: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##678:[a] -&gt; {VV : GHC.Types.Int | VV == Lib.length lq_tmp$x##678
                                           &amp;&amp; VV == len lq_tmp$x##678}</span><span class='hs-definition'>length</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##704 : GHC.Prim.Int# | lq_tmp$x##704 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>19: </span><span class='hs-definition'>length</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##750 : GHC.Types.Int | lq_tmp$x##750 == GHC.Types.I# lq_anf$##7205759403792803346##d2xc
                                 &amp;&amp; lq_tmp$x##750 == (lq_anf$##7205759403792803346##d2xc : int)}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##759 : GHC.Types.Int | lq_tmp$x##759 == Lib.length xs##a1wF
                                 &amp;&amp; lq_tmp$x##759 == len xs##a1wF}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##770 : [a] | lq_tmp$x##770 == xs##a1wF
                       &amp;&amp; Lib.pot lq_tmp$x##770 == len lq_tmp$x##770
                       &amp;&amp; len lq_tmp$x##770 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>pot</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>22: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>pot</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-keyword'>{v:</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>| v = (len xs)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>23: </span><span class='hs-definition'>pot</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>24: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##790:[a] -&gt; {VV : GHC.Types.Int | VV == Lib.pot lq_tmp$x##790
                                           &amp;&amp; VV == len lq_tmp$x##790}</span><span class='hs-definition'>pot</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##816 : GHC.Prim.Int# | lq_tmp$x##816 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>25: </span><span class='hs-definition'>pot</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##862 : GHC.Types.Int | lq_tmp$x##862 == GHC.Types.I# lq_anf$##7205759403792803351##d2xh
                                 &amp;&amp; lq_tmp$x##862 == (lq_anf$##7205759403792803351##d2xh : int)}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##871 : GHC.Types.Int | lq_tmp$x##871 == Lib.pot xs##a1wH
                                 &amp;&amp; lq_tmp$x##871 == len xs##a1wH}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>pot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##882 : [a] | lq_tmp$x##882 == xs##a1wH
                       &amp;&amp; Lib.length lq_tmp$x##882 == len lq_tmp$x##882
                       &amp;&amp; len lq_tmp$x##882 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>26: </span>
<span class=hs-linenum>27: </span><span class='hs-comment'>-- amortised cost 2</span>
<span class=hs-linenum>28: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>push</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{t:</span><span class='hs-conid'>Tick</span> <span class='hs-keyword'>{ys:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len ys = 1 + (len xs) }</span> <span class='hs-keyword'>| (pot xs) + 2 &gt;= (tcost t) + (pot (tval t))}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>29: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##902:[a] -&gt; lq_tmp$x##903:a -&gt; {t : (Language.Haskell.Liquid.RTick.Tick {ys : [a] | len ys == 1 + len lq_tmp$x##902}) | Lib.pot lq_tmp$x##902 + 2 &gt;= Language.Haskell.Liquid.RTick.tcost t + Lib.pot (Language.Haskell.Liquid.RTick.tval t)}</span><span class='hs-definition'>push</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>ls</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RTick.wait</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##916 : [{lq_tmp$x##926 : a | $k_##925[VV##924:=lq_tmp$x##926][lq_tmp$x##920:=a##a1wJ][lq_tmp$x##921:=ls##a1wI]}]&lt;\lq_tmp$x##923 VV -&gt; {lq_tmp$x##926 : a | $k_##928[VV##927:=lq_tmp$x##926][lq_tmp$x##920:=a##a1wJ][lq_tmp$x##921:=ls##a1wI][lq_tmp$x##929:=lq_tmp$x##923]}&gt; | is$GHC.Types.: lq_tmp$x##916
                                                                                                                                                                                                                                                                                         &amp;&amp; not (is$GHC.Types.[] lq_tmp$x##916)
                                                                                                                                                                                                                                                                                         &amp;&amp; lq_tmp$x##916 == GHC.Types.: a##a1wJ ls##a1wI
                                                                                                                                                                                                                                                                                         &amp;&amp; Lib.length lq_tmp$x##916 == 1 + Lib.length ls##a1wI
                                                                                                                                                                                                                                                                                         &amp;&amp; Lib.pot lq_tmp$x##916 == 1 + Lib.pot ls##a1wI
                                                                                                                                                                                                                                                                                         &amp;&amp; head lq_tmp$x##916 == a##a1wJ
                                                                                                                                                                                                                                                                                         &amp;&amp; len lq_tmp$x##916 == 1 + len ls##a1wI
                                                                                                                                                                                                                                                                                         &amp;&amp; lqdc##$select##GHC.Types.:##1 lq_tmp$x##916 == a##a1wJ
                                                                                                                                                                                                                                                                                         &amp;&amp; lqdc##$select##GHC.Types.:##2 lq_tmp$x##916 == ls##a1wI
                                                                                                                                                                                                                                                                                         &amp;&amp; tail lq_tmp$x##916 == ls##a1wI}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##931 : a | lq_tmp$x##931 == a##a1wJ}</span><span class='hs-varid'>a</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##935 : [a] | lq_tmp$x##935 == ls##a1wI
                       &amp;&amp; Lib.length lq_tmp$x##935 == len lq_tmp$x##935
                       &amp;&amp; Lib.pot lq_tmp$x##935 == len lq_tmp$x##935
                       &amp;&amp; len lq_tmp$x##935 &gt;= 0}</span><span class='hs-varid'>ls</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>30: </span>
<span class=hs-linenum>31: </span><span class='hs-comment'>-- amortised cost 0</span>
<span class=hs-linenum>32: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>pop</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{xs:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| k &lt;= (len xs)}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{t:</span><span class='hs-conid'>Tick</span> <span class='hs-keyword'>{ys:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| (len ys) = (len xs) - k}</span> <span class='hs-keyword'>| (pot xs) + 2 &gt;= (tcost t) + (pot (tval t))}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>33: </span><span class='hs-definition'>pop</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tick</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>34: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##962:{VV##0 : GHC.Types.Int | VV##0 &gt;= 0} -&gt; lq_tmp$x##963:{xs : [a] | lq_tmp$x##962 &lt;= len xs} -&gt; {t : (Language.Haskell.Liquid.RTick.Tick {ys : [a] | len ys == len lq_tmp$x##963 - lq_tmp$x##962}) | Lib.pot lq_tmp$x##963 + 2 &gt;= Language.Haskell.Liquid.RTick.tcost t + Lib.pot (Language.Haskell.Liquid.RTick.tval t)}</span><span class='hs-definition'>pop</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>{xs : [a] | ds_d2wu &lt;= len xs}</span><span class='hs-varid'>ys</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a7k0 .
      lq_tmp$x##1161:a##a7k0 -&gt; {lq_tmp$x##1159 : (Language.Haskell.Liquid.RTick.Tick a##a7k0) | 0 == Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1159
                                                                                                 &amp;&amp; lq_tmp$x##1159 == Language.Haskell.Liquid.RTick.return lq_tmp$x##1161
                                                                                                 &amp;&amp; lq_tmp$x##1159 == Language.Haskell.Liquid.RTick.Tick 0 lq_tmp$x##1161
                                                                                                 &amp;&amp; lq_tmp$x##1161 == Language.Haskell.Liquid.RTick.tval lq_tmp$x##1159} | VV == Language.Haskell.Liquid.RTick.return}</span><span class='hs-conid'>RTick.return</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1176 : [a] | lq_tmp$x##1176 == ys##a1wK
                        &amp;&amp; Lib.length lq_tmp$x##1176 == len lq_tmp$x##1176
                        &amp;&amp; Lib.pot lq_tmp$x##1176 == len lq_tmp$x##1176
                        &amp;&amp; len lq_tmp$x##1176 &gt;= 0
                        &amp;&amp; ds_d2wu &lt;= len lq_tmp$x##1176}</span><span class='hs-varid'>ys</span></a>     
<span class=hs-linenum>35: </span><span class='hs-definition'>pop</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a7i4 .
      lq_tmp$x##1135:GHC.Types.Int -&gt; lq_tmp$x##1136:(Language.Haskell.Liquid.RTick.Tick a##a7i4) -&gt; {lq_tmp$x##1132 : (Language.Haskell.Liquid.RTick.Tick a##a7i4) | lq_tmp$x##1132 == Language.Haskell.Liquid.RTick.Tick (lq_tmp$x##1135 + Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1136) (Language.Haskell.Liquid.RTick.tval lq_tmp$x##1136)
                                                                                                                                                                      &amp;&amp; lq_tmp$x##1132 == Language.Haskell.Liquid.RTick.step lq_tmp$x##1135 lq_tmp$x##1136
                                                                                                                                                                      &amp;&amp; Language.Haskell.Liquid.RTick.tval lq_tmp$x##1136 == Language.Haskell.Liquid.RTick.tval lq_tmp$x##1132
                                                                                                                                                                      &amp;&amp; lq_tmp$x##1135 + Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1136 == Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1132} | VV == Language.Haskell.Liquid.RTick.step}</span><span class='hs-conid'>RTick.step</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1071 : GHC.Types.Int | lq_tmp$x##1071 == GHC.Types.I# lq_anf$##7205759403792803359##d2xp
                                  &amp;&amp; lq_tmp$x##1071 == (lq_anf$##7205759403792803359##d2xp : int)}</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1110 : (Language.Haskell.Liquid.RTick.Tick {lq_tmp$x##1109 : [{lq_tmp$x##1120 : a | $k_##1119[VV##1118:=lq_tmp$x##1120][lq_tmp$x##1114:=lq_anf$##7205759403792803363##d2xt][lq_tmp$x##1115:=xs##a1wN]}] | len lq_tmp$x##1109 == len xs##a1wN - lq_anf$##7205759403792803363##d2xt}) | lq_tmp$x##1110 == Lib.pop lq_anf$##7205759403792803363##d2xt xs##a1wN
                                                                                                                                                                                                                                                                                                 &amp;&amp; Lib.pot xs##a1wN + 2 &gt;= Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1110 + Lib.pot (Language.Haskell.Liquid.RTick.tval lq_tmp$x##1110)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>pop</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1095 : GHC.Types.Int | lq_tmp$x##1095 == GHC.Num.- ds_d2wu lq_anf$##7205759403792803362##d2xs
                                  &amp;&amp; lq_tmp$x##1095 == ds_d2wu - lq_anf$##7205759403792803362##d2xs}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1098 : GHC.Types.Int | lq_tmp$x##1098 == ds_d2wu
                                  &amp;&amp; lq_tmp$x##1098 &gt;= 0}</span><span class='hs-varid'>k</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1079 : GHC.Types.Int | lq_tmp$x##1079 == GHC.Types.I# lq_anf$##7205759403792803361##d2xr
                                  &amp;&amp; lq_tmp$x##1079 == (lq_anf$##7205759403792803361##d2xr : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1125 : [a] | lq_tmp$x##1125 == xs##a1wN
                        &amp;&amp; Lib.length lq_tmp$x##1125 == len lq_tmp$x##1125
                        &amp;&amp; Lib.pot lq_tmp$x##1125 == len lq_tmp$x##1125
                        &amp;&amp; len lq_tmp$x##1125 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
</pre>
</body>
</html>