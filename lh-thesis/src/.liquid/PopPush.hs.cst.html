<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/PopPush.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##1180 : GHC.Types.Module | $k_##1181}</span><span class='hs-keyword'>{-@</span></a> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--reflection"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 2: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>PopPush</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 5: </span>
<span class=hs-linenum> 6: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 7: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Liquid.ProofCombinators</span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Liquid.RTick</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>RTick</span>
<span class=hs-linenum> 9: </span>
<span class=hs-linenum>10: </span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nil</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Cons</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>12: </span>
<span class=hs-linenum>13: </span><span class='hs-comment'>-- push &amp; pop</span>
<span class=hs-linenum>14: </span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>length</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>length</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>| v = (len xs)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>17: </span><span class='hs-definition'>length</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>18: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##679:[a] -&gt; {VV : GHC.Types.Int | VV == PopPush.length lq_tmp$x##679
                                           &amp;&amp; VV == len lq_tmp$x##679}</span><span class='hs-definition'>length</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##705 : GHC.Prim.Int# | lq_tmp$x##705 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>19: </span><span class='hs-definition'>length</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##751 : GHC.Types.Int | lq_tmp$x##751 == GHC.Types.I# lq_anf$##7205759403792803251##d2vF
                                 &amp;&amp; lq_tmp$x##751 == (lq_anf$##7205759403792803251##d2vF : int)}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##760 : GHC.Types.Int | lq_tmp$x##760 == PopPush.length xs##a1uQ
                                 &amp;&amp; lq_tmp$x##760 == len xs##a1uQ}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##771 : [a] | lq_tmp$x##771 == xs##a1uQ
                       &amp;&amp; PopPush.pot lq_tmp$x##771 == len lq_tmp$x##771
                       &amp;&amp; len lq_tmp$x##771 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>pot</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>22: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>pot</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-keyword'>{v:</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>| v = (len xs)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>23: </span><span class='hs-definition'>pot</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>24: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##791:[a] -&gt; {VV : GHC.Types.Int | VV == PopPush.pot lq_tmp$x##791
                                           &amp;&amp; VV == len lq_tmp$x##791}</span><span class='hs-definition'>pot</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##817 : GHC.Prim.Int# | lq_tmp$x##817 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>25: </span><span class='hs-definition'>pot</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##863 : GHC.Types.Int | lq_tmp$x##863 == GHC.Types.I# lq_anf$##7205759403792803256##d2vK
                                 &amp;&amp; lq_tmp$x##863 == (lq_anf$##7205759403792803256##d2vK : int)}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##872 : GHC.Types.Int | lq_tmp$x##872 == PopPush.pot xs##a1uS
                                 &amp;&amp; lq_tmp$x##872 == len xs##a1uS}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>pot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##883 : [a] | lq_tmp$x##883 == xs##a1uS
                       &amp;&amp; PopPush.length lq_tmp$x##883 == len lq_tmp$x##883
                       &amp;&amp; len lq_tmp$x##883 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>26: </span>
<span class=hs-linenum>27: </span><span class='hs-comment'>-- amortised cost 2</span>
<span class=hs-linenum>28: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>push</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{t:</span><span class='hs-conid'>Tick</span> <span class='hs-keyword'>{ys:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len ys = 1 + (len xs) }</span> <span class='hs-keyword'>| (pot xs) + 2 &gt;= (tcost t) + (pot (tval t))}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>29: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##903:[a] -&gt; lq_tmp$x##904:a -&gt; {t : (Language.Haskell.Liquid.RTick.Tick {ys : [a] | len ys == 1 + len lq_tmp$x##903}) | PopPush.pot lq_tmp$x##903 + 2 &gt;= Language.Haskell.Liquid.RTick.tcost t + PopPush.pot (Language.Haskell.Liquid.RTick.tval t)}</span><span class='hs-definition'>push</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>ls</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RTick.wait</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##917 : [{lq_tmp$x##927 : a | $k_##926[VV##925:=lq_tmp$x##927][lq_tmp$x##921:=a##a1uU][lq_tmp$x##922:=ls##a1uT]}]&lt;\lq_tmp$x##924 VV -&gt; {lq_tmp$x##927 : a | $k_##929[VV##928:=lq_tmp$x##927][lq_tmp$x##921:=a##a1uU][lq_tmp$x##922:=ls##a1uT][lq_tmp$x##930:=lq_tmp$x##924]}&gt; | is$GHC.Types.: lq_tmp$x##917
                                                                                                                                                                                                                                                                                         &amp;&amp; not (is$GHC.Types.[] lq_tmp$x##917)
                                                                                                                                                                                                                                                                                         &amp;&amp; lq_tmp$x##917 == GHC.Types.: a##a1uU ls##a1uT
                                                                                                                                                                                                                                                                                         &amp;&amp; PopPush.length lq_tmp$x##917 == 1 + PopPush.length ls##a1uT
                                                                                                                                                                                                                                                                                         &amp;&amp; PopPush.pot lq_tmp$x##917 == 1 + PopPush.pot ls##a1uT
                                                                                                                                                                                                                                                                                         &amp;&amp; head lq_tmp$x##917 == a##a1uU
                                                                                                                                                                                                                                                                                         &amp;&amp; len lq_tmp$x##917 == 1 + len ls##a1uT
                                                                                                                                                                                                                                                                                         &amp;&amp; lqdc##$select##GHC.Types.:##1 lq_tmp$x##917 == a##a1uU
                                                                                                                                                                                                                                                                                         &amp;&amp; lqdc##$select##GHC.Types.:##2 lq_tmp$x##917 == ls##a1uT
                                                                                                                                                                                                                                                                                         &amp;&amp; tail lq_tmp$x##917 == ls##a1uT}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##932 : a | lq_tmp$x##932 == a##a1uU}</span><span class='hs-varid'>a</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##936 : [a] | lq_tmp$x##936 == ls##a1uT
                       &amp;&amp; PopPush.length lq_tmp$x##936 == len lq_tmp$x##936
                       &amp;&amp; PopPush.pot lq_tmp$x##936 == len lq_tmp$x##936
                       &amp;&amp; len lq_tmp$x##936 &gt;= 0}</span><span class='hs-varid'>ls</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>30: </span>
<span class=hs-linenum>31: </span><span class='hs-comment'>-- amortised cost 0</span>
<span class=hs-linenum>32: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>pop</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{xs:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| k &lt;= (len xs)}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{t:</span><span class='hs-conid'>Tick</span> <span class='hs-keyword'>{ys:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| (len ys) = (len xs) - k}</span> <span class='hs-keyword'>| (pot xs) + 2 &gt;= (tcost t) + (pot (tval t))}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>33: </span><span class='hs-definition'>pop</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tick</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>34: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##963:{VV##0 : GHC.Types.Int | VV##0 &gt;= 0} -&gt; lq_tmp$x##964:{xs : [a] | lq_tmp$x##963 &lt;= len xs} -&gt; {t : (Language.Haskell.Liquid.RTick.Tick {ys : [a] | len ys == len lq_tmp$x##964 - lq_tmp$x##963}) | PopPush.pot lq_tmp$x##964 + 2 &gt;= Language.Haskell.Liquid.RTick.tcost t + PopPush.pot (Language.Haskell.Liquid.RTick.tval t)}</span><span class='hs-definition'>pop</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>{xs : [a] | ds_d2uM &lt;= len xs}</span><span class='hs-varid'>ys</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a7k0 .
      lq_tmp$x##1162:a##a7k0 -&gt; {lq_tmp$x##1160 : (Language.Haskell.Liquid.RTick.Tick a##a7k0) | 0 == Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1160
                                                                                                 &amp;&amp; lq_tmp$x##1160 == Language.Haskell.Liquid.RTick.return lq_tmp$x##1162
                                                                                                 &amp;&amp; lq_tmp$x##1160 == Language.Haskell.Liquid.RTick.Tick 0 lq_tmp$x##1162
                                                                                                 &amp;&amp; lq_tmp$x##1162 == Language.Haskell.Liquid.RTick.tval lq_tmp$x##1160} | VV == Language.Haskell.Liquid.RTick.return}</span><span class='hs-conid'>RTick.return</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1177 : [a] | lq_tmp$x##1177 == ys##a1uV
                        &amp;&amp; PopPush.length lq_tmp$x##1177 == len lq_tmp$x##1177
                        &amp;&amp; PopPush.pot lq_tmp$x##1177 == len lq_tmp$x##1177
                        &amp;&amp; len lq_tmp$x##1177 &gt;= 0
                        &amp;&amp; ds_d2uM &lt;= len lq_tmp$x##1177}</span><span class='hs-varid'>ys</span></a>     
<span class=hs-linenum>35: </span><span class='hs-definition'>pop</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a7i4 .
      lq_tmp$x##1136:GHC.Types.Int -&gt; lq_tmp$x##1137:(Language.Haskell.Liquid.RTick.Tick a##a7i4) -&gt; {lq_tmp$x##1133 : (Language.Haskell.Liquid.RTick.Tick a##a7i4) | lq_tmp$x##1133 == Language.Haskell.Liquid.RTick.Tick (lq_tmp$x##1136 + Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1137) (Language.Haskell.Liquid.RTick.tval lq_tmp$x##1137)
                                                                                                                                                                      &amp;&amp; lq_tmp$x##1133 == Language.Haskell.Liquid.RTick.step lq_tmp$x##1136 lq_tmp$x##1137
                                                                                                                                                                      &amp;&amp; Language.Haskell.Liquid.RTick.tval lq_tmp$x##1137 == Language.Haskell.Liquid.RTick.tval lq_tmp$x##1133
                                                                                                                                                                      &amp;&amp; lq_tmp$x##1136 + Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1137 == Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1133} | VV == Language.Haskell.Liquid.RTick.step}</span><span class='hs-conid'>RTick.step</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1072 : GHC.Types.Int | lq_tmp$x##1072 == GHC.Types.I# lq_anf$##7205759403792803264##d2vS
                                  &amp;&amp; lq_tmp$x##1072 == (lq_anf$##7205759403792803264##d2vS : int)}</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1111 : (Language.Haskell.Liquid.RTick.Tick {lq_tmp$x##1110 : [{lq_tmp$x##1121 : a | $k_##1120[VV##1119:=lq_tmp$x##1121][lq_tmp$x##1115:=lq_anf$##7205759403792803268##d2vW][lq_tmp$x##1116:=xs##a1uY]}] | len lq_tmp$x##1110 == len xs##a1uY - lq_anf$##7205759403792803268##d2vW}) | lq_tmp$x##1111 == PopPush.pop lq_anf$##7205759403792803268##d2vW xs##a1uY
                                                                                                                                                                                                                                                                                                 &amp;&amp; PopPush.pot xs##a1uY + 2 &gt;= Language.Haskell.Liquid.RTick.tcost lq_tmp$x##1111 + PopPush.pot (Language.Haskell.Liquid.RTick.tval lq_tmp$x##1111)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>pop</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1096 : GHC.Types.Int | lq_tmp$x##1096 == GHC.Num.- ds_d2uM lq_anf$##7205759403792803267##d2vV
                                  &amp;&amp; lq_tmp$x##1096 == ds_d2uM - lq_anf$##7205759403792803267##d2vV}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1099 : GHC.Types.Int | lq_tmp$x##1099 == ds_d2uM
                                  &amp;&amp; lq_tmp$x##1099 &gt;= 0}</span><span class='hs-varid'>k</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1080 : GHC.Types.Int | lq_tmp$x##1080 == GHC.Types.I# lq_anf$##7205759403792803266##d2vU
                                  &amp;&amp; lq_tmp$x##1080 == (lq_anf$##7205759403792803266##d2vU : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1126 : [a] | lq_tmp$x##1126 == xs##a1uY
                        &amp;&amp; PopPush.length lq_tmp$x##1126 == len lq_tmp$x##1126
                        &amp;&amp; PopPush.pot lq_tmp$x##1126 == len lq_tmp$x##1126
                        &amp;&amp; len lq_tmp$x##1126 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
</pre>
</body>
</html>